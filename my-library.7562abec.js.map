{"mappings":"oeAAAA,EAAA,SCAA,MAAMC,EAAO,CACTC,cAAeC,SAASC,cAAc,6BACtCC,UAAWF,SAASC,cAAc,eAClCE,SAAUH,SAASC,cAAc,aACjCG,QAASJ,SAASC,cAAc,cAEvBF,cAAEM,EAAaH,UAAEI,EAASH,SAAEI,EAAQH,QAAEI,GAAYV,E,wDCA/D,MAAMW,GAAW,EAAAC,EAAAC,WACjB,IAAIC,EA6BJ,SAASC,EAAYC,GACjBR,EAAUS,UAAUC,OAAO,UAC3BT,EAASQ,UAAUC,OAAO,UAC1BF,EAAMG,OAAOF,UAAUG,IAAI,UAE3BC,aAAaC,QAAQ,SAAUN,EAAMG,OAAOI,MAC5CC,EAAaR,EAAMG,OAAOI,KAAM,E,CAa7BE,eAAeD,EAAaE,EAAYC,GAC3C,MAAMC,EAAOC,KAAKC,MAAMC,eAAeC,QAAQ,SAE/C,IAAIC,EAAWL,QAAajB,EAASuB,aAAaN,EAAKO,KAAO,KAC9DF,EAAWA,GAAY,GAEvB,IAAIG,EAAcR,EACZK,EAASP,IAAe,GACxBG,KAAKC,MAAMT,aAAaW,QAAQN,KAAgB,GAEtD,MAAMW,EApBV,WACI,IAAIA,EAMJ,OAJIA,EADAC,OAAOC,YAAc,KACX,EACHD,OAAOC,YAAc,IAClB,EACG,EACVF,C,CAaSG,GAGhB,IAAIC,EADiB3B,GAAR,EAAA4B,EAAA7B,SAAcuB,EAAYO,OAAQN,EAAS9B,GAGxDO,EAAW8B,GAAG,aAAa5B,IAIvB,GAHAT,EAAcsC,gBAAgB,SAG1BT,EAAYO,QAAUN,EAAS,CAC/B,GAAmB,IAAfrB,EAAM8B,KAEN,YADAC,WAAW,GAGfxC,EAAcyC,aAAa,QAAS,gB,CAExCP,EAAcL,EAAYa,MACtBjC,EAAM8B,KAAOT,EAAUA,EACvBrB,EAAM8B,KAAOT,GAEjB3B,EAAQwC,WAAY,EAAAC,EAAAC,cAAaX,GACjCpB,aAAaC,QAAQ,KAAMO,KAAKwB,UAAUZ,IAC1CV,eAAeT,QAAQ,OAAQN,EAAM8B,KAAK,IAE9ChC,EAAWwC,WAAW3B,E,CAhF1BzB,SAASqD,KAAKC,iBAAiB,SAE/B,WACIhC,EACIH,aAAaW,QAAQ,UACrBD,eAAeC,QAAQ,Q,KAI/B,EAAAyB,EAAAC,cAIyE,WACjElD,IACAA,EAAUgD,iBAAiB,QAASzC,GACpCN,EAAS+C,iBAAiB,QAASzC,GACI,UAAnCM,aAAaW,QAAQ,UAErBvB,EAASkD,cAAc,IAAIC,MAAM,UAEjCpD,EAAUmD,cAAc,IAAIC,MAAM,WAG1C7B,eAAeT,QAAQ,SAAU,U,CAbrCuC,G","sources":["src/my-library.js","src/js/refsLibrary.js","src/js/showLibrary.js"],"sourcesContent":["import './js/autorization';\nimport './js/showLibrary';\nimport './js/modalFilm';\nimport './js/scrollUp';\nimport './js/modal_developer';\n","const refs = {\n    pagiContainer: document.querySelector('#tui-pagination-container'),\n    wachedBtn: document.querySelector('.js-watched'),\n    queueBtn: document.querySelector('.js-queue'),\n    gallery: document.querySelector('.gallery'),\n};\nexport const { pagiContainer, wachedBtn, queueBtn, gallery } = refs;\n","import { pagiContainer, wachedBtn, queueBtn, gallery } from './refsLibrary';\nimport { createMarkup } from './createMarkup';\nimport getPagination from './pagination';\nimport getDataBase from './DataBase';\nimport { checkLogin } from './autorization';\n\nconst dataBase = getDataBase();\nlet pagination;\n\ndocument.body.addEventListener('close', rerender);\n\nfunction rerender() {\n    createPagina(\n        localStorage.getItem('Active'),\n        sessionStorage.getItem('Page')\n    );\n}\n\ncheckLogin();\n\nrenderGallery();\n// кликнули на кнопку, вызов события клик на кнопки в зависимости от того какая имеет класс \"active\"\nfunction renderGallery() {\n    if (wachedBtn) {\n        wachedBtn.addEventListener('click', showLibrary);\n        queueBtn.addEventListener('click', showLibrary);\n        if (localStorage.getItem('Active') === 'queue') {\n            //имитация клика на кнопку\n            queueBtn.dispatchEvent(new Event('click'));\n        } else {\n            wachedBtn.dispatchEvent(new Event('click'));\n        }\n    }\n    sessionStorage.setItem('window', 'library');\n}\n\nfunction showLibrary(event) {\n    wachedBtn.classList.remove('active');\n    queueBtn.classList.remove('active');\n    event.target.classList.add('active');\n\n    localStorage.setItem('Active', event.target.name);\n    createPagina(event.target.name, 1);\n}\n\nfunction getPerPage() {\n    let perPage;\n    if (window.innerWidth >= 1280) {\n        perPage = 9;\n    } else if (window.innerWidth >= 768) {\n        perPage = 8;\n    } else perPage = 4;\n    return perPage;\n}\n\nexport async function createPagina(buttonName, currentPage) {\n    const user = JSON.parse(sessionStorage.getItem('user'));\n\n    let userData = user ? await dataBase.readUserData(user.uid) : null;\n    userData = userData || {};\n\n    let libraryList = user\n        ? userData[buttonName] || []\n        : JSON.parse(localStorage.getItem(buttonName)) || [];\n\n    const perPage = getPerPage();\n    // заново строим пагинацию\n    pagination = getPagination(libraryList.length, perPage, pagiContainer);\n    let visibleList;\n\n    pagination.on('afterMove', event => {\n        pagiContainer.removeAttribute('style');\n\n        // если меньше фильмов чем на одной странице может быть то убрать пагинацию\n        if (libraryList.length <= perPage) {\n            if (event.page === 2) {\n                moveToPage(1);\n                return;\n            }\n            pagiContainer.setAttribute('style', 'display: none');\n        }\n        visibleList = libraryList.slice(\n            event.page * perPage - perPage,\n            event.page * perPage\n        );\n        gallery.innerHTML = createMarkup(visibleList);\n        localStorage.setItem('LS', JSON.stringify(visibleList));\n        sessionStorage.setItem('Page', event.page);\n    });\n    pagination.movePageTo(currentPage);\n}\n"],"names":["parcelRequire","$59f85f3c996554c3$var$refs","pagiContainer","document","querySelector","wachedBtn","queueBtn","gallery","$59f85f3c996554c3$export$d4c815942f91c976","$59f85f3c996554c3$export$77cb092ee3b9ded9","$59f85f3c996554c3$export$3ad7dfcfd8f39a63","$59f85f3c996554c3$export$b21c1b4271bdbe93","$248414b1a2c66b65$var$dataBase","$f63xy","default","$248414b1a2c66b65$var$pagination","$248414b1a2c66b65$var$showLibrary","event","classList","remove","target","add","localStorage","setItem","name","$248414b1a2c66b65$export$104ac1c911e67c8b","async","buttonName","currentPage","user","JSON","parse","sessionStorage","getItem","userData","readUserData","uid","libraryList","perPage","window","innerWidth","$248414b1a2c66b65$var$getPerPage","visibleList","$2nhTy","length","on","removeAttribute","page","moveToPage","setAttribute","slice","innerHTML","$g4lwF","createMarkup","stringify","movePageTo","body","addEventListener","$8pSXg","checkLogin","dispatchEvent","Event","$248414b1a2c66b65$var$renderGallery"],"version":3,"file":"my-library.7562abec.js.map"}