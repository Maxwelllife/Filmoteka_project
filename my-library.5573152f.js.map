{"mappings":"iiBAAAA,EAAA,SCAA,IAOIC,EAPJC,EAAAF,EAAA,S,aCAMG,EAAO,CACTC,cAAeC,SAASC,cAAc,6BACtCC,UAAWF,SAASC,cAAc,eAClCE,SAAUH,SAASC,cAAc,aACjCG,QAASJ,SAASC,cAAc,aAErBI,EAAgDP,EAAhDC,cAAeO,EAAiCR,EAAjCI,UAAWK,EAAsBT,EAAtBK,SAAUK,EAAYV,EAAZM,Q,oDDA7CK,GAAW,EAAAC,EAAAC,WA8BjB,SAASC,EAAYC,GACjBP,EAAUQ,UAAUC,OAAO,UAC3BR,EAASO,UAAUC,OAAO,UAC1BF,EAAMG,OAAOF,UAAUG,IAAI,UAE3BC,aAAaC,QAAQ,SAAUN,EAAMG,OAAOI,MAC5CC,EAAaR,EAAMG,OAAOI,KAAM,E,CAGpC,SAASE,IAOL,OALIC,OAAOC,YAAc,KACX,EACHD,OAAOC,YAAc,IAClB,EACG,C,UAICH,EAAaI,EAAYC,G,OAAzBC,EAAYC,MAAAC,KAAAC,U,UAAZH,I,OAAAA,EAAfI,EAAAlC,EAAA,CAAAkC,EAAAC,GAAAC,MAAA,SAAAC,EAA4BT,EAAYC,G,IACrCS,EAEFC,EAGAC,EAIEC,EAGFC,E,uEAZEJ,EAAOK,KAAKC,MAAMC,eAAeC,QAAQ,UAE5B,C,+BAASlC,EAASmC,aAAaT,EAAKU,K,8CAAO,K,OAC9DT,GADIA,EAAQU,EAAAC,KACW,GAEnBV,EAAcF,EACZC,EAASX,IAAe,GACxBe,KAAKC,MAAMvB,aAAayB,QAAQlB,KAAgB,GAEhDa,EAAUhB,KAEhB1B,GAAa,EAAAoD,EAAArC,SAAc0B,EAAYY,OAAQX,EAASjC,IAG7C6C,GAAG,aAAa,SAAArC,GAIvB,GAHAR,EAAc8C,gBAAgB,SAG1Bd,EAAYY,QAAUX,EAAS,CAC/B,GAAmB,IAAfzB,EAAMuC,KAEN,YADAC,WAAW,GAGfhD,EAAciD,aAAa,QAAS,gB,CAExCf,EAAcF,EAAYkB,MACtB1C,EAAMuC,KAAOd,EAAUA,EACvBzB,EAAMuC,KAAOd,GAEjB9B,EAAQgD,WAAY,EAAAC,EAAAC,cAAanB,GACjCrB,aAAaC,QAAQ,KAAMqB,KAAKmB,UAAUpB,IAC1CG,eAAevB,QAAQ,OAAQN,EAAMuC,K,IAEzCxD,EAAWgE,WAAWlC,G,6CAlCQE,MAAAC,KAAAC,U,CA9ClC9B,SAAS6D,KAAKC,iBAAiB,SAE/B,WACIzC,EACIH,aAAayB,QAAQ,UACrBD,eAAeC,QAAQ,Q,KAI/B,EAAAoB,EAAAC,cAIyE,WACjE1D,IACAA,EAAUwD,iBAAiB,QAASlD,GACpCL,EAASuD,iBAAiB,QAASlD,GACI,UAAnCM,aAAayB,QAAQ,UAErBpC,EAAS0D,cAAc,IAAIC,MAAM,UAEjC5D,EAAU2D,cAAc,IAAIC,MAAM,WAG1CxB,eAAevB,QAAQ,SAAU,U,CAbrCgD,G","sources":["src/my-library.js","src/js/showLibrary.js","src/js/refsLibrary.js"],"sourcesContent":["import './js/autorization';\nimport './js/showLibrary';\nimport './js/modalFilm';\nimport './js/scrollUp';\nimport './js/modal_developer';\n","import { pagiContainer, wachedBtn, queueBtn, gallery } from './refsLibrary';\nimport { createMarkup } from './createMarkup';\nimport getPagination from './pagination';\nimport getDataBase from './DataBase';\nimport { checkLogin } from './autorization';\n\nconst dataBase = getDataBase();\nlet pagination;\n\ndocument.body.addEventListener('close', rerender);\n\nfunction rerender() {\n    createPagina(\n        localStorage.getItem('Active'),\n        sessionStorage.getItem('Page')\n    );\n}\n\ncheckLogin();\n\nrenderGallery();\n// кликнули на кнопку, вызов события клик на кнопки в зависимости от того какая имеет класс \"active\"\nfunction renderGallery() {\n    if (wachedBtn) {\n        wachedBtn.addEventListener('click', showLibrary);\n        queueBtn.addEventListener('click', showLibrary);\n        if (localStorage.getItem('Active') === 'queue') {\n            //имитация клика на кнопку\n            queueBtn.dispatchEvent(new Event('click'));\n        } else {\n            wachedBtn.dispatchEvent(new Event('click'));\n        }\n    }\n    sessionStorage.setItem('window', 'library');\n}\n\nfunction showLibrary(event) {\n    wachedBtn.classList.remove('active');\n    queueBtn.classList.remove('active');\n    event.target.classList.add('active');\n\n    localStorage.setItem('Active', event.target.name);\n    createPagina(event.target.name, 1);\n}\n\nfunction getPerPage() {\n    let perPage;\n    if (window.innerWidth >= 1280) {\n        perPage = 9;\n    } else if (window.innerWidth >= 768) {\n        perPage = 8;\n    } else perPage = 4;\n    return perPage;\n}\n\nexport async function createPagina(buttonName, currentPage) {\n    const user = JSON.parse(sessionStorage.getItem('user'));\n\n    let userData = user ? await dataBase.readUserData(user.uid) : null;\n    userData = userData || {};\n\n    let libraryList = user\n        ? userData[buttonName] || []\n        : JSON.parse(localStorage.getItem(buttonName)) || [];\n\n    const perPage = getPerPage();\n    // заново строим пагинацию\n    pagination = getPagination(libraryList.length, perPage, pagiContainer);\n    let visibleList;\n\n    pagination.on('afterMove', event => {\n        pagiContainer.removeAttribute('style');\n\n        // если меньше фильмов чем на одной странице может быть то убрать пагинацию\n        if (libraryList.length <= perPage) {\n            if (event.page === 2) {\n                moveToPage(1);\n                return;\n            }\n            pagiContainer.setAttribute('style', 'display: none');\n        }\n        visibleList = libraryList.slice(\n            event.page * perPage - perPage,\n            event.page * perPage\n        );\n        gallery.innerHTML = createMarkup(visibleList);\n        localStorage.setItem('LS', JSON.stringify(visibleList));\n        sessionStorage.setItem('Page', event.page);\n    });\n    pagination.movePageTo(currentPage);\n}\n","const refs = {\n    pagiContainer: document.querySelector('#tui-pagination-container'),\n    wachedBtn: document.querySelector('.js-watched'),\n    queueBtn: document.querySelector('.js-queue'),\n    gallery: document.querySelector('.gallery'),\n};\nexport const { pagiContainer, wachedBtn, queueBtn, gallery } = refs;\n"],"names":["parcelRequire","$b88163a50e57f9ec$var$pagination","$bpxeT","$acdf13b65e2d24dc$var$refs","pagiContainer","document","querySelector","wachedBtn","queueBtn","gallery","$acdf13b65e2d24dc$export$d4c815942f91c976","$acdf13b65e2d24dc$export$77cb092ee3b9ded9","$acdf13b65e2d24dc$export$3ad7dfcfd8f39a63","$acdf13b65e2d24dc$export$b21c1b4271bdbe93","$b88163a50e57f9ec$var$dataBase","$bHp6M","default","$b88163a50e57f9ec$var$showLibrary","event","classList","remove","target","add","localStorage","setItem","name","$b88163a50e57f9ec$export$104ac1c911e67c8b","$b88163a50e57f9ec$var$getPerPage","window","innerWidth","buttonName","currentPage","$b88163a50e57f9ec$var$_createPagina","apply","this","arguments","$parcel$interopDefault","$2TvXO","mark","_callee","user","userData","libraryList","perPage","visibleList","JSON","parse","sessionStorage","getItem","readUserData","uid","_ctx","t0","$jcFG7","length","on","removeAttribute","page","moveToPage","setAttribute","slice","innerHTML","$9XBOy","createMarkup","stringify","movePageTo","body","addEventListener","$3BGx8","checkLogin","dispatchEvent","Event","$b88163a50e57f9ec$var$renderGallery"],"version":3,"file":"my-library.5573152f.js.map"}